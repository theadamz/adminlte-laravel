import{v as u,y as l,A as _,e as d,M as i,s as n,m as s,B as m,f as v,r as g,g as f,l as e}from"./general-DAK3ebw_.js";let c=null;const L=document.querySelector("#formInput");let a={};function V(){_formValidation=$(L).validate({rules:{asset_alias_id:{required:!0,regex:u},asset_name:{required:!0,regex:u},category:{required:!0},category_sub:{required:!0},brand:{required:!0},model:{required:!0},status:{required:!0},serial_number:{required:!0},user:{required:!0},building:{required:!0},location:{required:!0},supplier:{required:!0},purchase_no:{required:!0},purchase_date:{required:!0,dateValid:!0},purchase_cost:{required:!0,formatNumber:!0},weight:{required:!0,formatNumber:!0},warranty_date:{required:!0,dateValid:!0},eol_date:{required:!0,dateValid:!0}},submitHandler:p})}function O(){l("#purchase_date","date"),l("#warranty_date","date"),l("#eol_date","date"),_("#purchase_cost","float"),document.getElementById("choose_pic").addEventListener("click",function(){$("#picture").click()}),$("#picture").change(function(){if(this.files&&this.files[0]){let r=new FileReader;r.onload=function(o){$("#picture_preview").attr("src",o.target.result)},r.readAsDataURL(this.files[0]),r.onloadend=function(){r.abort()}}}),document.getElementById("categoryLOV").addEventListener("click",F),document.getElementById("subCategoryLOV").addEventListener("click",h),document.getElementById("brandLOV").addEventListener("click",y),document.getElementById("modelLOV").addEventListener("click",E),document.getElementById("supplierLOV").addEventListener("click",w),document.getElementById("userLOV").addEventListener("click",q),document.getElementById("buildingLOV").addEventListener("click",k),document.getElementById("locationLOV").addEventListener("click",C)}function b(){d("#asset_alias_id"),d("#asset_name"),d("#serial_number"),d("#purchase_no")}function p(){i.Confirm("Are you sure?").then(r=>{n(!0,"#save"),c=`${_baseURL}/inventories/smart-devices/${_id}`;const o="POST";_data2Send=new FormData($("#formInput")[0]),_data2Send.append("_method","PUT"),_data2Send.append("purchase_date",s($("#purchase_date").datetimepicker("viewDate"),"YYYY-MM-DD")),_data2Send.append("warranty_date",s($("#warranty_date").datetimepicker("viewDate"),"YYYY-MM-DD")),_data2Send.append("eol_date",s($("#eol_date").datetimepicker("viewDate"),"YYYY-MM-DD")),_data2Send.append("purchase_cost",m($("#purchase_cost").val())),_data2Send.append("weight",m($("#weight").val())),console.log("Form data:",Array.from(_data2Send.entries())),v(c,o,_data2Send,null).then(t=>{[200].includes(t.status)?(Toast.fire({icon:"success",title:t.statusText,text:t.data.message}),$("#modalFormInput").modal("hide")):(i.HtmlNotification(g(t.data),`${t.status} - ${t.statusText}`),f(t.data.errors)),n(!1,"#save")}).catch(t=>{i.Notification(t.toString()),n(!1,"#save")})}).catch(r=>{r&&console.log(r)})}function F(){e(),$("#_dynamic_content").load(`${_baseURL}/lov/configs/inventories/categories?is_active=true`,()=>{e(!1),$("#_modal_lov").modal("show"),$(".modal-dialog").addClass("modal-lg"),$("#_modal_lov").on("hide.bs.modal",function(){if($resultFromLOV.result){if(a.category==$resultFromLOV.data.id)return;a.category=$resultFromLOV.data.id,$("#category").val($resultFromLOV.data.id),$("#category_name").val($resultFromLOV.data.name),$("#category_sub").val(null),$("#category_sub_name").val(null)}})})}function h(){$("#category").val()&&(e(),$("#_dynamic_content").load(`${_baseURL}/lov/configs/inventories/sub-categories?category=${$("#category").val()}`,()=>{e(!1),$("#_modal_lov").modal("show"),$(".modal-dialog").addClass("modal-lg"),$("#_modal_lov").on("hide.bs.modal",function(){if($resultFromLOV.result){if(a.category_sub==$resultFromLOV.data.id)return;a.category_sub=$resultFromLOV.data.id,$("#category_sub").val($resultFromLOV.data.id),$("#category_sub_name").val($resultFromLOV.data.name)}})}))}function y(){e(),$("#_dynamic_content").load(`${_baseURL}/lov/configs/inventories/brands`,()=>{e(!1),$("#_modal_lov").modal("show"),$(".modal-dialog").addClass("modal-lg"),$("#_modal_lov").on("hide.bs.modal",function(){if($resultFromLOV.result){if(a.brand==$resultFromLOV.data.id)return;a.brand=$resultFromLOV.data.id,$("#brand").val($resultFromLOV.data.id),$("#brand_name").val($resultFromLOV.data.name),$("#model").val(null),$("#model_name").val(null)}})})}function E(){$("#brand").val()&&(e(),$("#_dynamic_content").load(`${_baseURL}/lov/configs/inventories/models?brand=${$("#brand").val()}`,()=>{e(!1),$("#_modal_lov").modal("show"),$(".modal-dialog").addClass("modal-lg"),$("#_modal_lov").on("hide.bs.modal",function(){if($resultFromLOV.result){if(a.model==$resultFromLOV.data.id)return;a.model=$resultFromLOV.data.id,$("#model").val($resultFromLOV.data.id),$("#model_name").val($resultFromLOV.data.name)}})}))}function w(){e(),$("#_dynamic_content").load(`${_baseURL}/lov/configs/inventories/suppliers?is_active=true`,()=>{e(!1),$("#_modal_lov").modal("show"),$(".modal-dialog").addClass("modal-lg"),$("#_modal_lov").on("hide.bs.modal",function(){if($resultFromLOV.result){if(a.supplier==$resultFromLOV.data.id)return;a.supplier=$resultFromLOV.data.id,$("#supplier").val($resultFromLOV.data.id),$("#supplier_name").val($resultFromLOV.data.name)}})})}function q(){e(),$("#_dynamic_content").load(`${_baseURL}/lov/configs/setups/users`,()=>{e(!1),$("#_modal_lov").modal("show"),$(".modal-dialog").addClass("modal-lg"),$("#_modal_lov").on("hide.bs.modal",function(){if($resultFromLOV.result){if(a.user==$resultFromLOV.data.id)return;a.user=$resultFromLOV.data.id,$("#user").val($resultFromLOV.data.id),$("#username").val($resultFromLOV.data.name),$("#department").val($resultFromLOV.data.department_id)}})})}function k(){e(),$("#_dynamic_content").load(`${_baseURL}/lov/configs/setups/buildings?is_active=true`,()=>{e(!1),$("#_modal_lov").modal("show"),$(".modal-dialog").addClass("modal-lg"),$("#_modal_lov").on("hide.bs.modal",function(){if($resultFromLOV.result){if(a.building==$resultFromLOV.data.id)return;a.building=$resultFromLOV.data.id,$("#building").val($resultFromLOV.data.id),$("#building_name").val($resultFromLOV.data.name),$("#location").val(null),$("#location_name").val(null)}})})}function C(){$("#building").val()&&(e(),$("#_dynamic_content").load(`${_baseURL}/lov/configs/setups/locations?is_active=true&building=${$("#building").val()}`,()=>{e(!1),$("#_modal_lov").modal("show"),$(".modal-dialog").addClass("modal-lg"),$("#_modal_lov").on("hide.bs.modal",function(){if($resultFromLOV.result){if(a.asset_smart_device==$resultFromLOV.data.id)return;a.asset_smart_device=$resultFromLOV.data.id,$("#location").val($resultFromLOV.data.id),$("#location_name").val($resultFromLOV.data.name)}})}))}document.addEventListener("DOMContentLoaded",function(){V(),O(),b()});

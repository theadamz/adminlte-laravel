import{b as f,i as m,a as b,c as h,d as _,e as g,M as l,s as n,f as c,r,g as T,h as i,j as p,_ as S}from"./general-DAK3ebw_.js";let o=null;const x=document.querySelector("#formInput");function k(){_dataTable=$("#list_datatable").DataTable({lengthMenu:[[10,50,100,-1],[10,50,100,"All"]],pageLength:50,numbers_length:4,searchDelay:500,processing:!0,serverSide:!0,scrollX:!0,stateSave:_dataTableUseState,stateDuration:_dataTableStateDuration,scrollY:_dataTableScrollY,order:[[0,"asc"]],select:{items:"row",style:"single",className:"bg-warning"},headerCallback:function(e,t,a,s,j){e.getElementsByTagName("th")[0].innerHTML=`
            <div class="form-check">
               <input class="form-check-input datatable-group-checkable" type="checkbox" value="" id="groupCheckable" />
					<label class="form-check-label"></label>
            </div>`},createdRow:function(e,t,a){_dataTableSelectedValues.indexOf(t[_dataTableSelectColumn])>-1&&$(e).addClass("bg-light")},ajax:{url:`${_baseURL}/dt/knowledges`,type:"GET",data:function(e){e.is_publish=$("#filter_is_publish").val()}},columns:[{data:"id",width:"30px",orderable:!1,searchable:!1,render:function(e,t,a,s){return`<div class="form-check">
                               <input class="form-check-input datatable-checkable" type="checkbox" value="${e}" ${_dataTableSelectedValues.indexOf(e)>-1?"checked":""} data-index="${s.row}" />
                                        <label class="form-check-label"></label>
                            </div>`}},{data:"subject",render:function(e,t,a,s){return`<div class="d-flex flex-column">
                               ${a.subject}
                               <span><a href="${_baseURL}/clients/knowledges/${a.slug}" target="_blank" class="text-muted"><em><small>${_baseURL}/clients/knowledges/${a.slug}</small></em></a></span>
                            </div>`}},{data:"excerpt"},{data:"is_publish",width:"80px",className:"dt-center",searchable:!1,render:function(e,t,a,s){return f(e)?'<span class="badge font-weight-normal badge-success">Yes</span>':'<span class="badge font-weight-normal badge-warning">No</span>'}}]}).on("xhr.dt",function(e,t,a,s){setTimeout(()=>{_dataTable.columns.adjust()},300)}).on("draw.dt",function(e,t,a,s){m(_dataTable)}),b(_dataTable,'input[type="search"]'),document.querySelector("#refresh").addEventListener("click",()=>d(!1)),document.querySelector("#filterReset").addEventListener("click",F),document.querySelector("#formFilter").addEventListener("submit",e=>{e.preventDefault(),d(),$("#modalFormFilter").modal("hide")})}function v(){_formValidation=$(x).validate({rules:{subject:{required:!0},content:{required:!1}},submitHandler:L})}function w(){$("#modalFormInput").on("hidden.bs.modal",u),h("#modalFormInput"),_("#content","content","200px")}function y(){_permissions.edit&&document.querySelector("#edit").addEventListener("click",()=>{typeof _dataTable.row({selected:!0}).data()>"u"||D(_dataTable.row({selected:!0}).data().id.trim())}),_permissions.delete&&document.querySelector("#delete").addEventListener("click",C)}function E(){g("#subject")}function L(){l.Confirm("Are you sure?").then(e=>{n(!0,"#save"),o=`${_baseURL}/knowledges`,_action==="edit"&&(o+=`/${_id}`);const t=_action==="create"?"POST":"PUT";_data2Send=$("#formInput").serialize(),c(o,t,_data2Send).then(a=>{[201,200].includes(a.status)?(_action="create",Toast.fire({icon:"success",title:a.statusText,text:a.data.message}),u(),d(!1),$("#modalFormInput").modal("hide")):(l.HtmlNotification(r(a.data),`${a.status} - ${a.statusText}`),T(a.data.errors)),n(!1,"#save")}).catch(a=>{l.Notification(a.toString()),n(!1,"#save")})}).catch(e=>{e&&console.log(e)})}function D(e=null){_id=e,i("#list_datatable"),c(`${_baseURL}/knowledges/${_id}`,"GET",null).then(t=>{if([200].includes(t.status)){u(),_action="edit";const a=t.data.data;$("#subject").val(a.subject),p("content",a.content),$("#is_publish").prop("checked",f(a.is_publish)),$("#modalFormInput").modal("show")}else l.HtmlNotification(r(t.data),`${t.status} - ${t.statusText}`);i("#list_datatable",!1)}).catch(t=>{l.Notification(t.toString()),i("#list_datatable",!1)})}function C(){if(_dataTableSelectedValues.length<=0){l.HtmlNotification("Select 1 atau more data.");return}l.Confirm(`Are you sure want to delete ${_dataTableSelectedValues.length} data?`,null,"warning").then(e=>{n(!0,"#delete"),i("#list_datatable"),_data2Send=new URLSearchParams({id:JSON.stringify(_dataTableSelectedValues)}),c(`${_baseURL}/knowledges`,"DELETE",_data2Send).then(t=>{[200].includes(t.status)?(Toast.fire({icon:"success",title:t.statusText,text:t.data.message}),S(),d(!1)):l.HtmlNotification(r(t.data),`${t.status} - ${t.statusText}`),n(!1,"#delete"),i("#list_datatable",!1)}).catch(t=>{l.Notification(t.toString()),n(!1,"#delete"),i("#list_datatable",!1)})}).catch(e=>{e&&console.log(e)})}function d(e=!0){_dataTableResetFilter=!1,_dataTable.ajax.reload(null,e)}function u(){_action="create",_data2Send=null,_formValidation.resetForm(),$("#formInput")[0].reset()}function F(){$('#filter_is_publish option[value=""]').prop("selected",!0).change(),$("#formFilter")[0].reset()}document.addEventListener("DOMContentLoaded",function(){k(),v(),w(),E(),y()});
